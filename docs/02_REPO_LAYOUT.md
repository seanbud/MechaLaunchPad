# 02 — Repository Layout

## Strategy: Three Repositories

| Repo | Purpose | Who pushes |
|---|---|---|
| `mechalaunchpad-tool` | PySide6 app, validation module, CI helper scripts | Developer |
| `mech-assets` | Published FBX files + metadata JSONs | MechaLaunchPad (on behalf of artist) |
| `mech-unity` | Unity project that receives validated assets, generates prefabs | CI bot |

> **MVP simplification**: During the one-day build, `mechalaunchpad-tool` and `mech-assets` can be combined into a single mono-repo with separate top-level directories. Split later.

---

## `mechalaunchpad-tool/` (or mono-repo root)

```
mechalaunchpad-tool/
├── app/                          # PySide6 application
│   ├── __main__.py               # Entry point
│   ├── main_window.py            # QMainWindow setup, tab switching
│   ├── tabs/
│   │   ├── export_template.py    # Export Template tab
│   │   ├── import_validate.py    # Import / Validate tab
│   │   ├── preview.py            # Preview tab
│   │   ├── publish.py            # Publish tab
│   │   └── ci_status.py          # CI Status tab
│   ├── preview/
│   │   ├── renderer.py           # Blender headless render bridge
│   │   └── stitch.py             # Part stitching logic
│   ├── gitlab/
│   │   ├── client.py             # GitLab REST API wrapper
│   │   └── git_ops.py            # GitPython commit/push helpers
│   └── widgets/                  # Shared PySide6 widgets
│       ├── log_panel.py
│       └── status_badge.py
│
├── validation/                   # Shared validation module (local + CI)
│   ├── __init__.py
│   ├── runner.py                 # Orchestrates all rules
│   ├── rules/
│   │   ├── naming.py
│   │   ├── materials.py
│   │   ├── bone_set.py
│   │   ├── tri_count.py
│   │   ├── transforms.py
│   │   └── sockets.py
│   └── result.py                 # ValidationResult dataclass + JSON serialiser
│
├── templates/                    # Canonical rig + guide meshes
│   ├── BasicTemplate.blend       # Source Blender file
│   └── BasicTemplate.fbx         # Pre-exported canonical FBX
│
├── scripts/                      # CI helper scripts
│   ├── ci_validate.py            # CLI entry point: runs validation, outputs JSON
│   └── ci_unity_ingest.py        # Calls Unity batchmode
│
├── config/
│   ├── part_registry.json        # Part categories, bone whitelists, slot defs
│   └── material_whitelist.json   # Approved material names
│
├── .gitlab-ci.yml
├── requirements.txt
├── pyproject.toml
└── README.md
```

---

## `mech-assets/` (published assets)

```
mech-assets/
├── parts/
│   ├── LeftArm/
│   │   ├── v001/
│   │   │   ├── LeftArm_v001.fbx
│   │   │   ├── LeftArm_v001_meta.json
│   │   │   └── LeftArm_v001_preview.png   # Generated by CI
│   │   └── v002/
│   │       ├── LeftArm_v002.fbx
│   │       ├── LeftArm_v002_meta.json
│   │       └── LeftArm_v002_preview.png
│   ├── Head/
│   │   └── ...
│   └── Torso/
│       └── ...
│
├── accessories/
│   ├── HeavyGun/
│   │   └── v001/
│   │       ├── HeavyGun_v001.fbx
│   │       └── HeavyGun_v001_meta.json
│   └── JetPack/
│       └── ...
│
└── latest.json                   # Pointers to latest blessed version per part
```

---

## `mech-unity/` (Unity project)

```
mech-unity/
├── Assets/
│   ├── MechParts/                # Imported FBX copies
│   │   ├── LeftArm/
│   │   │   └── LeftArm_v001.fbx
│   │   └── ...
│   ├── Prefabs/
│   │   ├── LeftArm_v001.prefab
│   │   └── ...
│   ├── Thumbnails/
│   │   └── LeftArm_v001.png
│   ├── Editor/
│   │   └── MechPartImporter.cs   # AssetPostprocessor + prefab builder
│   └── Scripts/
│       └── AttachmentSlot.cs     # Runtime slot component
├── Packages/
├── ProjectSettings/
└── .gitlab-ci.yml                # Separate CI for Unity project
```

---

## Branching Strategy

| Repo | Branch | Purpose |
|---|---|---|
| `mech-assets` | `main` | Latest blessed assets |
| `mech-assets` | `submit/<Part>/<version>` | Per-submission branch (auto-created by tool) |
| `mechalaunchpad-tool` | `main` | Stable tool code |
| `mech-unity` | `main` | Auto-updated by CI |
